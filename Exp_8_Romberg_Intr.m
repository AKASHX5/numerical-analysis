clc
clear all;
close all;

x=0:0.1:0.8;
n=length(x);
f=[1.000000 0.990050 0.960789 0.913931 0.852144 0.778801 0.697676 0.612626 0.527292];
h1=x(n)-x(1);
h2=h1/2;
h3=h1/4;
h4=h1/8;
I(1,1)=(h1/2)*(f(1)+f(n));
I(2,1)=(h2/2)*(f(1)+2*f(5)+f(n));
I(3,1)=(h3/2)*(f(1)+2*f(3)+2*f(5)+2*f(7)+f(n));
I(4,1)=(h4/2)*(f(1)+2*f(2)+2*f(3)+2*f(4)+2*f(5)+2*f(6)+2*f(7)+2*f(8)+f(n));
for n=2:4
    for j=2:4
        I(j,n)=((4^(n-1)*I(j,(n-1)))-I(j-1,n-1))/(4^(n-1)-1);
        if j<n
            I(j,n)=0;
        end
    end
end
I(4,4)